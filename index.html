<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz Bíblico por Bloques</title>
  <style>
    body {
      font-family: sans-serif;
      padding: 20px;
      background: #fff8f0;
      color: #333;
    }
    .hidden { display: none; }
    button {
      padding: 10px 15px;
      margin: 5px;
      border: none;
      border-radius: 6px;
      background-color: #f4a261;
      color: white;
      cursor: pointer;
    }
    button:hover {
      background-color: #e76f51;
    }
    .option-group { margin: 10px 0; }
    .selected { background-color: #2a9d8f !important; }
    .question-box {
      margin: 20px 0;
      padding: 15px;
      background: #fdf6ec;
      border-radius: 8px;
      box-shadow: 0 0 5px #ccc;
    }
  </style>
</head>
<body>

  <h1>Quiz Bíblico</h1>

  <div id="bloques-container"></div>

  <div id="quiz-container" class="hidden">
    <div id="pregunta" class="question-box"></div>

    <div class="option-group">
      <strong>¿De qué libro es?</strong><br/>
      <div id="libro-opciones"></div>
    </div>

    <div class="option-group">
      <strong>¿Qué capítulo?</strong><br/>
      <div id="capitulo-opciones"></div>
    </div>

    <button id="siguiente-btn" class="hidden">Siguiente</button>
  </div>

  <div id="resultado" class="hidden"></div>

  <script>
    // Simulación de datos cargados (reemplazar con fetch si se usa archivo externo)
    const preguntas = [
      {
        "bloque": 1,
        "cita": "No os conforméis a este mundo, sino transformaos por la renovación de vuestra mente.",
        "libro": "Romanos",
        "capitulo": 12,
        "opcion_1": "Romanos",
        "opcion_2": "Corintios",
        "opcion_3": "Efesios",
        "opcion_4": "Gálatas",
        "opcion_cap_1": 12,
        "opcion_cap_2": 13,
        "opcion_cap_3": 11,
        "opcion_cap_4": 10
      },
      {
        "bloque": 2,
        "cita": "Amarás a tu prójimo como a ti mismo.",
        "libro": "Mateo",
        "capitulo": 22,
        "opcion_1": "Mateo",
        "opcion_2": "Levítico",
        "opcion_3": "Deuteronomio",
        "opcion_4": "Números",
        "opcion_cap_1": 22,
        "opcion_cap_2": 20,
        "opcion_cap_3": 25,
        "opcion_cap_4": 23
      }
    ];

    const bloquesContainer = document.getElementById('bloques-container');
    const quizContainer = document.getElementById('quiz-container');
    const preguntaDiv = document.getElementById('pregunta');
    const libroOpciones = document.getElementById('libro-opciones');
    const capituloOpciones = document.getElementById('capitulo-opciones');
    const siguienteBtn = document.getElementById('siguiente-btn');
    const resultadoDiv = document.getElementById('resultado');

    let preguntasDelBloque = [];
    let preguntaActual = 0;
    let respuestas = [];

    let seleccionLibro = null;
    let seleccionCapitulo = null;

    function mostrarBloques() {
      const bloquesUnicos = [...new Set(preguntas.map(p => p.bloque))];
      bloquesUnicos.forEach(bloque => {
        const btn = document.createElement('button');
        btn.textContent = `Bloque ${bloque}`;
        btn.onclick = () => comenzarBloque(bloque);
        bloquesContainer.appendChild(btn);
      });
    }

    function comenzarBloque(bloque) {
      preguntasDelBloque = preguntas.filter(p => p.bloque === bloque);
      preguntaActual = 0;
      respuestas = [];
      bloquesContainer.classList.add('hidden');
      quizContainer.classList.remove('hidden');
      mostrarPregunta();
    }

    function mostrarPregunta() {
      seleccionLibro = null;
      seleccionCapitulo = null;
      siguienteBtn.classList.add('hidden');

      const p = preguntasDelBloque[preguntaActual];
      preguntaDiv.textContent = p.cita;

      // Mostrar opciones de libro
      libroOpciones.innerHTML = '';
      [p.opcion_1, p.opcion_2, p.opcion_3, p.opcion_4].forEach(libro => {
        const btn = document.createElement('button');
        btn.textContent = libro;
        btn.onclick = () => {
          seleccionLibro = libro;
          [...libroOpciones.children].forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          verificarSeleccion();
        };
        libroOpciones.appendChild(btn);
      });

      // Mostrar opciones de capítulo
      capituloOpciones.innerHTML = '';
      [p.opcion_cap_1, p.opcion_cap_2, p.opcion_cap_3, p.opcion_cap_4].forEach(cap => {
        const btn = document.createElement('button');
        btn.textContent = cap;
        btn.onclick = () => {
          seleccionCapitulo = cap;
          [...capituloOpciones.children].forEach(b => b.classList.remove('selected'));
          btn.classList.add('selected');
          verificarSeleccion();
        };
        capituloOpciones.appendChild(btn);
      });
    }

    function verificarSeleccion() {
      if (seleccionLibro && seleccionCapitulo) {
        siguienteBtn.classList.remove('hidden');
      }
    }

    siguienteBtn.onclick = () => {
      const p = preguntasDelBloque[preguntaActual];
      const correctaLibro = seleccionLibro === p.libro;
      const correctoCapitulo = parseInt(seleccionCapitulo) === p.capitulo;

      respuestas.push({ correctaLibro, correctoCapitulo });

      preguntaActual++;
      if (preguntaActual < preguntasDelBloque.length) {
        mostrarPregunta();
      } else {
        mostrarResultado();
      }
    };

    function mostrarResultado() {
      quizContainer.classList.add('hidden');
      resultadoDiv.classList.remove('hidden');

      const total = respuestas.length;
      const correctosLibro = respuestas.filter(r => r.correctaLibro).length;
      const correctosCap = respuestas.filter(r => r.correctoCapitulo).length;

      resultadoDiv.innerHTML = `
        <h2>Resultados</h2>
        <p><strong>Libros correctos:</strong> ${correctosLibro} de ${total}</p>
        <p><strong>Capítulos correctos:</strong> ${correctosCap} de ${total}</p>
        <button onclick="location.reload()">Volver a elegir bloque</button>
      `;
    }

    mostrarBloques();
  </script>

</body>
</html>
