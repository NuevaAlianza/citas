<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Quiz Bíblico: ¿Dónde está esta cita?</title>
  <style>
    body {
      background-color: #1e1e2f;
      color: #f0e6d2;
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    header {
      background: linear-gradient(90deg, #3a2f2f, #2c2a2a);
      padding: 1rem;
      box-shadow: 0 2px 5px rgba(255, 215, 0, 0.2);
    }
    h1 {
      color: #ffd700;
      margin: 0;
    }
    select, button {
      margin: 1rem;
      padding: 0.5rem 1rem;
      font-size: 1rem;
      border-radius: 10px;
      border: none;
      background-color: #333;
      color: #ffd700;
      cursor: pointer;
    }
    .quiz-container {
      max-width: 600px;
      margin: auto;
      background-color: #292935;
      padding: 2rem;
      border-radius: 1rem;
      margin-top: 2rem;
      box-shadow: 0 0 20px rgba(255, 215, 0, 0.1);
    }
    .quote {
      font-size: 1.2rem;
      margin-bottom: 2rem;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 1rem;
    }
    .option {
      background-color: #444;
      padding: 1rem;
      border-radius: 10px;
      flex: 1 1 40%;
      transition: all 0.2s;
    }
    .option.correct {
      background-color: #228B22;
    }
    .option.incorrect {
      background-color: #B22222;
    }
    .hidden {
      display: none;
    }
    .result {
      font-size: 1.2rem;
      margin-top: 2rem;
    }
  </style>
</head>
<body>

<header>
  <h1>¿Dónde está esta cita?</h1>
</header>

<div>
  <select id="bloqueSelector">
    <option value="">Selecciona un bloque</option>
  </select>
  <button onclick="iniciarQuiz()">Comenzar</button>
</div>

<div class="quiz-container hidden" id="quiz">
  <div class="quote" id="citaTexto"></div>
  <div class="options">
    <div id="libros" class="options"></div>
    <div id="capitulos" class="options"></div>
  </div>
  <div class="result hidden" id="resultadoFinal"></div>
</div>

<script id="citas-json" type="application/json">
{
  "bloques": [
    {
      "nombre": "bloque 1",
      "citas": [
        {
          "texto": "El Señor es mi pastor, nada me falta.",
          "libro": "Salmos",
          "capitulo": "23"
        },
        {
          "texto": "En el principio creó Dios los cielos y la tierra.",
          "libro": "Génesis",
          "capitulo": "1"
        }
      ]
    },
    {
      "nombre": "bloque 2",
      "citas": [
        {
          "texto": "Yo soy el camino, la verdad y la vida.",
          "libro": "Juan",
          "capitulo": "14"
        }
      ]
    }
  ]
}
</script>

<script>
  let datos = JSON.parse(document.getElementById('citas-json').textContent);
  let citas = [], citaActual = 0, aciertosLibro = 0, aciertosCapitulo = 0;

  const bloqueSelector = document.getElementById("bloqueSelector");
  datos.bloques.forEach((b, i) => {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = b.nombre;
    bloqueSelector.appendChild(opt);
  });

  function iniciarQuiz() {
    const bloque = datos.bloques[bloqueSelector.value];
    if (!bloque) return alert("Selecciona un bloque válido");
    citas = [...bloque.citas];
    shuffleArray(citas);
    citaActual = 0;
    aciertosLibro = 0;
    aciertosCapitulo = 0;
    document.getElementById("resultadoFinal").classList.add("hidden");
    document.getElementById("quiz").classList.remove("hidden");
    mostrarCita();
  }

  function mostrarCita() {
    const cita = citas[citaActual];
    document.getElementById("citaTexto").textContent = `"${cita.texto}"`;
    mostrarOpciones("libros", getOpciones(cita.libro, librosBiblia), cita.libro, true);
    mostrarOpciones("capitulos", getOpciones(cita.capitulo, capitulosAleatorios()), cita.capitulo, false);
  }

  function mostrarOpciones(id, opciones, correcta, esLibro) {
    const cont = document.getElementById(id);
    cont.innerHTML = "";
    opciones.forEach(op => {
      const btn = document.createElement("div");
      btn.className = "option";
      btn.textContent = op;
      btn.onclick = () => {
        const correcto = op === correcta;
        btn.classList.add(correcto ? "correct" : "incorrect");
        if (esLibro && correcto) aciertosLibro++;
        if (!esLibro && correcto) aciertosCapitulo++;
        setTimeout(() => {
          if (esLibro) {
            mostrarOpciones("libros", [], "", true);
          } else {
            citaActual++;
            if (citaActual < citas.length) {
              mostrarCita();
            } else {
              mostrarResultado();
            }
          }
        }, 500);
      };
      cont.appendChild(btn);
    });
  }

  function mostrarResultado() {
    const total = citas.length;
    const texto = `Resultado: ${aciertosLibro}/${total} libros correctos, ${aciertosCapitulo}/${total} capítulos correctos`;
    const res = document.getElementById("resultadoFinal");
    res.textContent = texto;
    res.classList.remove("hidden");
  }

  function getOpciones(correcta, lista) {
    const opciones = [correcta];
    while (opciones.length < 4) {
      const aleatoria = lista[Math.floor(Math.random() * lista.length)];
      if (!opciones.includes(aleatoria)) opciones.push(aleatoria);
    }
    return shuffleArray(opciones);
  }

  function shuffleArray(arr) {
    return arr.sort(() => Math.random() - 0.5);
  }

  const librosBiblia = [
    "Génesis", "Éxodo", "Levítico", "Números", "Deuteronomio", "Josué",
    "Jueces", "Rut", "1 Samuel", "2 Samuel", "1 Reyes", "2 Reyes",
    "1 Crónicas", "2 Crónicas", "Esdras", "Nehemías", "Ester", "Job",
    "Salmos", "Proverbios", "Eclesiastés", "Cantares", "Isaías", "Jeremías",
    "Lamentaciones", "Ezequiel", "Daniel", "Oseas", "Joel", "Amós", "Abdías",
    "Jonás", "Miqueas", "Nahúm", "Habacuc", "Sofonías", "Hageo", "Zacarías",
    "Malaquías", "Mateo", "Marcos", "Lucas", "Juan", "Hechos", "Romanos",
    "1 Corintios", "2 Corintios", "Gálatas", "Efesios", "Filipenses",
    "Colosenses", "1 Tesalonicenses", "2 Tesalonicenses", "1 Timoteo",
    "2 Timoteo", "Tito", "Filemón", "Hebreos", "Santiago", "1 Pedro",
    "2 Pedro", "1 Juan", "2 Juan", "3 Juan", "Judas", "Apocalipsis"
  ];

  function capitulosAleatorios() {
    return Array.from({ length: 4 }, () => Math.ceil(Math.random() * 50).toString());
  }
</script>

</body>
</html>
